# Copyright 2023 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python-requests/2.28.1
      X-App-Name:
      - MA-Python-Lib-v0.1
    method: GET
    uri: https://api.intelligence.mandiant.com/v4/vulnerability?start_epoch=1662870397&limit=1&offset=0&end_epoch=1668565800
  response:
    body:
      string: "{\n    \"total_count\": 5260,\n    \"vulnerability\": [\n        {\n
        \           \"common_vulnerability_scores\": {\n                \"v2.0\":
        {\n                    \"availability_impact\": \"NONE\",\n                    \"temporal_score\":
        3.0,\n                    \"base_score\": 4.0,\n                    \"vector_string\":
        \"AV:N/AC:L/Au:S/C:P/I:N/A:N/E:U/RL:OF/RC:C\",\n                    \"integrity_impact\":
        \"NONE\",\n                    \"report_confidence\": \"CONFIRMED\",\n                    \"confidentiality_impact\":
        \"PARTIAL\",\n                    \"access_vector\": \"NETWORK\",\n                    \"remediation_level\":
        \"OFFICIAL_FIX\",\n                    \"exploitability\": \"UNPROVEN\",\n
        \                   \"access_complexity\": \"LOW\",\n                    \"authentication\":
        \"SINGLE\"\n                }\n            },\n            \"exploitation_state\":
        \"No Known\",\n            \"sources\": [\n                {\n                    \"date\":
        \"2022-11-09T21:00:00.000Z\",\n                    \"unique_id\": \"cisco-sa-fmc-xxe-MzPC4bYd\",\n
        \                   \"source_name\": \"Cisco Systems, Inc.\",\n                    \"url\":
        \"https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmc-xxe-MzPC4bYd\",\n
        \                   \"source_description\": \"Cisco Firepower Management Center
        Software XML External Entity Injection Vulnerability\"\n                }\n
        \           ],\n            \"risk_rating\": \"LOW\",\n            \"cve_id\":
        \"CVE-2022-20938\",\n            \"observed_in_the_wild\": false,\n            \"description\":
        \"<p>Cisco has provided the following description:</p>\\n<p><em>This vulnerability
        is due to insufficient validation of the XML syntax when importing a module.</em></p>\",\n
        \           \"id\": \"vulnerability--edc6a616-3bf1-5e66-9d0f-61e39ea6e2b6\",\n
        \           \"vulnerable_cpes\": [\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.6.0\",\n                    \"technology_name\":
        \"firepower_management_center 6.6.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.6.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.7.0\",\n                    \"technology_name\":
        \"firepower_management_center 6.7.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.7.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 7.0.1\",\n                    \"technology_name\":
        \"firepower_management_center 7.0.1\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:7.0.1:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.3.0\",\n                    \"technology_name\":
        \"firepower_management_center 6.3.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.3.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.6.3\",\n                    \"technology_name\":
        \"firepower_management_center 6.6.3\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.6.3:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.5.0\",\n                    \"technology_name\":
        \"firepower_management_center 6.5.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.5.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.1.0\",\n                    \"technology_name\":
        \"firepower_management_center 6.1.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.1.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 7.0.3\",\n                    \"technology_name\":
        \"firepower_management_center 7.0.3\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:7.0.3:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 7.1.0.1\",\n                    \"technology_name\":
        \"firepower_management_center 7.1.0.1\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:7.1.0.1:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 7.0.4\",\n                    \"technology_name\":
        \"firepower_management_center 7.0.4\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:7.0.4:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.6.4\",\n                    \"technology_name\":
        \"firepower_management_center 6.6.4\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.6.4:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.2.3\",\n                    \"technology_name\":
        \"firepower_management_center 6.2.3\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.2.3:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 7.0.2\",\n                    \"technology_name\":
        \"firepower_management_center 7.0.2\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:7.0.2:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.4.0\",\n                    \"technology_name\":
        \"firepower_management_center 6.4.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.4.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.6.5\",\n                    \"technology_name\":
        \"firepower_management_center 6.6.5\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.6.5:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.2.2\",\n                    \"technology_name\":
        \"firepower_management_center 6.2.2\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.2.2:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 7.1.0\",\n                    \"technology_name\":
        \"firepower_management_center 7.1.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:7.1.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.2.0\",\n                    \"technology_name\":
        \"firepower_management_center 6.2.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.2.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.2.1\",\n                    \"technology_name\":
        \"firepower_management_center 6.2.1\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.2.1:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 6.6.1\",\n                    \"technology_name\":
        \"firepower_management_center 6.6.1\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:6.6.1:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_management_center 7.1.0.2\",\n                    \"technology_name\":
        \"firepower_management_center 7.1.0.2\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_management_center:7.1.0.2:*:*:*:*:*:*:*\"\n
        \               }\n            ],\n            \"publish_date\": \"2022-11-16T01:20:00.000Z\",\n
        \           \"was_zero_day\": false,\n            \"intel_free\": false\n
        \       }\n    ]\n}"
    headers:
      Cache-Control:
      - max-age=3600, must-revalidate, private
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      Date:
      - Thu, 17 Nov 2022 20:16:54 GMT
      Strict-Transport-Security:
      - max-age=15724800; includeSubDomains
      Transfer-Encoding:
      - chunked
      Vary:
      - Origin
      - Accept-Encoding
      - Authorization
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python-requests/2.28.1
      X-App-Name:
      - MA-Python-Lib-v0.1
    method: GET
    uri: https://api.intelligence.mandiant.com/v4/vulnerability?limit=1&offset=1
  response:
    body:
      string: "{\n    \"total_count\": 10000,\n    \"vulnerability\": [\n        {\n
        \           \"common_vulnerability_scores\": {\n                \"v2.0\":
        {\n                    \"availability_impact\": \"PARTIAL\",\n                    \"temporal_score\":
        4.7,\n                    \"base_score\": 6.4,\n                    \"vector_string\":
        \"AV:N/AC:L/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C\",\n                    \"integrity_impact\":
        \"PARTIAL\",\n                    \"report_confidence\": \"CONFIRMED\",\n
        \                   \"confidentiality_impact\": \"NONE\",\n                    \"access_vector\":
        \"NETWORK\",\n                    \"remediation_level\": \"OFFICIAL_FIX\",\n
        \                   \"exploitability\": \"UNPROVEN\",\n                    \"access_complexity\":
        \"LOW\",\n                    \"authentication\": \"NONE\"\n                }\n
        \           },\n            \"exploitation_state\": \"No Known\",\n            \"sources\":
        [\n                {\n                    \"date\": \"2022-11-09T17:00:00.000Z\",\n
        \                   \"unique_id\": \"cisco-sa-snort-smb-3nfhJtr\",\n                    \"source_name\":
        \"Cisco Systems Inc.\",\n                    \"url\": \"https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-snort-smb-3nfhJtr\",\n
        \                   \"source_description\": \"Multiple Cisco Products Snort
        SMB2 Detection Engine Policy Bypass and Denial of Service Vulnerabilities\"\n
        \               },\n                {\n                    \"unique_id\":
        \"CSCwa55404\",\n                    \"source_name\": \"Cisco Systems Inc.\",\n
        \                   \"url\": \"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwa55404\",\n
        \                   \"source_description\": \"Multiple Cisco Products Snort
        SMB2 Detection Engine Policy Bypass and DoS Vulnerability\"\n                },\n
        \               {\n                    \"unique_id\": \"CSCwb66736\",\n                    \"source_name\":
        \"Cisco Systems Inc.\",\n                    \"url\": \"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb66736\",\n
        \                   \"source_description\": \"Multiple Cisco Products Snort
        SMB2 Detection Engine Policy Bypass and DoS Vulnerability\"\n                },\n
        \               {\n                    \"unique_id\": \"CSCwb87762\",\n                    \"source_name\":
        \"Cisco Systems Inc.\",\n                    \"url\": \"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb87762\",\n
        \                   \"source_description\": \"Multiple Cisco Products Snort
        SMB2 Detection Engine Policy Bypass and DoS Vulnerability\"\n                },\n
        \               {\n                    \"unique_id\": \"CSCwb91454\",\n                    \"source_name\":
        \"Cisco Systems Inc.\",\n                    \"url\": \"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwb91454\",\n
        \                   \"source_description\": \"Multiple Cisco Products Snort
        SMB2 Detection Engine Policy Bypass and DoS Vulnerability\"\n                },\n
        \               {\n                    \"unique_id\": \"CSCwc37339\",\n                    \"source_name\":
        \"Cisco Systems Inc.\",\n                    \"url\": \"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwc37339\",\n
        \                   \"source_description\": \"Multiple Cisco Products Snort
        SMB2 Detection Engine Policy Bypass and DoS Vulnerability\"\n                },\n
        \               {\n                    \"unique_id\": \"CSCwc37518\",\n                    \"source_name\":
        \"Cisco Systems Inc.\",\n                    \"url\": \"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCwc37518\",\n
        \                   \"source_description\": \"Multiple Cisco Products Snort
        SMB2 Detection Engine Policy Bypass and DoS Vulnerability\"\n                }\n
        \           ],\n            \"risk_rating\": \"LOW\",\n            \"cve_id\":
        \"CVE-2022-20922\",\n            \"observed_in_the_wild\": false,\n            \"description\":
        \"<p>Cisco has provided the following description:</p>\\n<p><em>These vulnerabilities
        are due to improper management of system resources when the Snort detection
        engine is processing SMB2 traffic. The <strong>snort preserve-connection</strong>
        option must be enabled for code execution to be possible. The option is enabled
        by default. Snort 2 version is not affected by this vulnerability.</em></p>\",\n
        \           \"id\": \"vulnerability--8dfe29f4-31b8-5a4f-921c-d2478e4ad048\",\n
        \           \"vulnerable_cpes\": [\n                {\n                    \"cpe_title\":
        \"cisco firepower_threat_defense 7.0.1\",\n                    \"technology_name\":
        \"firepower_threat_defense 7.0.1\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_threat_defense:7.0.1:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_threat_defense 7.2.0\",\n                    \"technology_name\":
        \"firepower_threat_defense 7.2.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_threat_defense:7.2.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_threat_defense *\",\n                    \"technology_name\":
        \"firepower_threat_defense *\",\n                    \"vendor_name\": \"cisco\",\n
        \                   \"cpe\": \"cpe:2.3:a:cisco:firepower_threat_defense:*:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco cyber_vision *\",\n                    \"technology_name\": \"cyber_vision
        *\",\n                    \"vendor_name\": \"cisco\",\n                    \"cpe\":
        \"cpe:2.3:a:cisco:cyber_vision:*:*:*:*:*:*:*:*\"\n                },\n                {\n
        \                   \"cpe_title\": \"cisco firepower_threat_defense 7.0.1.1\",\n
        \                   \"technology_name\": \"firepower_threat_defense 7.0.1.1\",\n
        \                   \"vendor_name\": \"cisco\",\n                    \"cpe\":
        \"cpe:2.3:a:cisco:firepower_threat_defense:7.0.1.1:*:*:*:*:*:*:*\"\n                },\n
        \               {\n                    \"cpe_title\": \"cisco firepower_threat_defense
        7.2.0.1\",\n                    \"technology_name\": \"firepower_threat_defense
        7.2.0.1\",\n                    \"vendor_name\": \"cisco\",\n                    \"cpe\":
        \"cpe:2.3:a:cisco:firepower_threat_defense:7.2.0.1:*:*:*:*:*:*:*\"\n                },\n
        \               {\n                    \"cpe_title\": \"cisco firepower_threat_defense
        7.0.0.1\",\n                    \"technology_name\": \"firepower_threat_defense
        7.0.0.1\",\n                    \"vendor_name\": \"cisco\",\n                    \"cpe\":
        \"cpe:2.3:a:cisco:firepower_threat_defense:7.0.0.1:*:*:*:*:*:*:*\"\n                },\n
        \               {\n                    \"cpe_title\": \"cisco umbrella_insights_virtual_appliance
        *\",\n                    \"technology_name\": \"umbrella_insights_virtual_appliance
        *\",\n                    \"vendor_name\": \"cisco\",\n                    \"cpe\":
        \"cpe:2.3:o:cisco:umbrella_insights_virtual_appliance:*:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_threat_defense 7.1.0.2\",\n                    \"technology_name\":
        \"firepower_threat_defense 7.1.0.2\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_threat_defense:7.1.0.2:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_threat_defense 7.0.0\",\n                    \"technology_name\":
        \"firepower_threat_defense 7.0.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_threat_defense:7.0.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_threat_defense 7.1.0\",\n                    \"technology_name\":
        \"firepower_threat_defense 7.1.0\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_threat_defense:7.1.0:*:*:*:*:*:*:*\"\n
        \               },\n                {\n                    \"cpe_title\":
        \"cisco firepower_threat_defense 7.1.0.1\",\n                    \"technology_name\":
        \"firepower_threat_defense 7.1.0.1\",\n                    \"vendor_name\":
        \"cisco\",\n                    \"cpe\": \"cpe:2.3:a:cisco:firepower_threat_defense:7.1.0.1:*:*:*:*:*:*:*\"\n
        \               }\n            ],\n            \"publish_date\": \"2022-11-17T19:30:00.000Z\",\n
        \           \"was_zero_day\": false,\n            \"intel_free\": false\n
        \       }\n    ]\n}"
    headers:
      Cache-Control:
      - max-age=3600, must-revalidate, private
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      Date:
      - Thu, 17 Nov 2022 20:16:54 GMT
      Strict-Transport-Security:
      - max-age=15724800; includeSubDomains
      Transfer-Encoding:
      - chunked
      Vary:
      - Origin
      - Accept-Encoding
      - Authorization
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - python-requests/2.28.1
      X-App-Name:
      - MA-Python-Lib-v0.1
    method: GET
    uri: https://api.intelligence.mandiant.com/v4/vulnerability?limit=1&offset=2
  response:
    body:
      string: "{\n    \"total_count\": 10000,\n    \"vulnerability\": []\n}"
    headers:
      Cache-Control:
      - max-age=3600, must-revalidate, private
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      Date:
      - Thu, 17 Nov 2022 20:16:54 GMT
      Strict-Transport-Security:
      - max-age=15724800; includeSubDomains
      Transfer-Encoding:
      - chunked
      Vary:
      - Origin
      - Accept-Encoding
      - Authorization
    status:
      code: 200
      message: OK
version: 1
